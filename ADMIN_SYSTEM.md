# نظام إدارة المسؤول (Admin System)

## نظرة عامة

تم إضافة نظام إدارة كامل للمسؤولين الذي يسمح بـ:

- مراجعة والموافقة على تطبيقات المعلمين الجدد
- إدارة أسعار خدمات المعلمين بمرونة كاملة
- متابعة حالة التطبيقات والخدمات بشكل فوري

## المزايا الرئيسية

### 1. لوحة التحكم (Admin Dashboard)

**المسار:** `/admin`

توفر نظرة عامة على:

- عدد التطبيقات المعلقة والقيد المراجعة والموافق عليها والمرفوضة
- عدد الخدمات المعلقة والنشطة
- وصول سريع لإدارة التطبيقات والخدمات

### 2. إدارة تطبيقات المعلمين

#### صفحة القائمة

**المسار:** `/admin/applications`

**المزايا:**

- عرض جميع التطبيقات مع إمكانية الفلترة حسب الحالة
- عرض سريع لمعلومات المعلم الأساسية
- الانتقال المباشر لتفاصيل التطبيق

**حالات التطبيق:**

1. **معلق (Pending)** - تطبيق جديد بانتظار المراجعة
2. **قيد المراجعة (Under Review)** - قيد فحص المستندات
3. **موافق عليه (Approved)** - تم الموافقة على المعلم
4. **مرفوض (Rejected)** - تم رفض التطبيق

#### صفحة التفاصيل

**المسار:** `/admin/applications/:id`

**المعلومات المعروضة:**

- البيانات الشخصية الكاملة للمعلم
- السيرة الذاتية والمؤهلات
- جميع المستندات المرفوعة (شهادة التحفيظ، الإجازة، الهوية)
- الملاحظات السابقة من المسؤول

**الإجراءات المتاحة:**

1. **الموافقة** - الموافقة على التطبيق كاملاً
2. **الرفض** - رفض التطبيق مع تحديد السبب
3. **طلب مستندات** - طلب مستندات إضافية من المعلم

### 3. إدارة خدمات المعلمين

#### صفحة القائمة

**المسار:** `/admin/services`

**المزايا:**

- عرض جميع الخدمات المعروضة من المعلمين
- فلترة حسب حالة الموافقة
- عرض السعر المطلوب والسعر النهائي
- نوع الخدمة (تحفيظ، تجويد، إلخ)

**حالات الخدمات:**

1. **بانتظار الموافقة (Pending Approval)** - خدمة جديدة بانتظار المراجعة
2. **قيد المراجعة (Under Review)** - قيد فحص السعر والتفاصيل
3. **نشطة (Active)** - موافق عليها ونشطة
4. **مرفوضة (Rejected)** - تم رفضها

#### صفحة التفاصيل

**المسار:** `/admin/services/:id`

**المعلومات المعروضة:**

- بيانات المعلم
- نوع الخدمة المدقق
- السعر المطلوب من المعلم
- السعر النهائي المعتمد
- تاريخ الإضافة

**الإجراءات المتاحة:**

1. **الموافقة على السعر** - الموافقة على السعر المطلوب
2. **تعديل السعر والموافقة** - تعديل السعر والموافقة على الخدمة
3. **رفض** - رفض الخدمة بسبب معين

## API Endpoints

### التطبيقات

```
GET /admin/applications/
- الفلتر اختياري: ?status=1 (للحالة المحددة)
- الرد يحتوي على قائمة التطبيقات مع البيانات الأساسية

GET /admin/applications/<id>/
- الرد يحتوي على تفاصيل كاملة للتطبيق والمستندات

PATCH /admin/applications/<id>/approve/
- الإجراء 1: الموافقة
- الإجراء 2: الرفض
- الإجراء 3: طلب مستندات إضافية
```

### الخدمات

```
GET /admin/teacher-services/
- الفلتر اختياري: ?status=1 (للحالة المحددة)
- الرد يحتوي على قائمة الخدمات

PATCH /admin/teacher-services/<id>/approve/
- action: "approve" / "adjust_rate" / "reject"
- admin_final_rate: للسعر الجديد عند التعديل
```

## دور الوصول (Authorization)

يتم التحقق من صلاحية المستخدم تلقائياً عند الوصول إلى صفحات Admin:

- يجب أن يكون المستخدم مسجل دخول (authenticated)
- يجب أن يكون دوره `admin`
- سيتم إعادة التوجيه للصفحة الرئيسية إذا لم يكن مسؤول

## مثال استخدام في الواجهة

```typescript
import { AdminDashboard } from "./pages/admin/AdminDashboard";
import { AdminApplicationsPage } from "./pages/admin/AdminApplicationsPage";
import { AdminServicesPage } from "./pages/admin/AdminServicesPage";

// في App.tsx يتم استخدام AdminOnly wrapper
<Route
  path="/admin"
  element={
    <AdminOnly>
      <AdminDashboard />
    </AdminOnly>
  }
/>
```

## الألوان والتصميم

- **الخلفية:** Dark theme (Slate 900-800)
- **البطاقات:** Slate 800 مع borders Slate 700
- **الأيقونات:** Lucide icons
- **الأزرار:** مختلفة حسب نوع الإجراء
  - أخضر (Approve/Success)
  - أزرق (Modify/Info)
  - أحمر (Reject/Danger)

## الملاحظات

1. جميع التنبيهات تستخدم `alert()` الآن للتوافق الكامل
2. يتم تحديث البيانات تلقائياً بعد أي إجراء
3. يمكن للمسؤول إضافة ملاحظات مفصلة قبل أي إجراء
4. جميع الأوقات تُعرض بصيغة التاريخ المحلية العربية
